<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Solve a system of polynomial equations - Buchbergers algorithm for computing Groebner basis</title>
  <meta name="description" content="What are polynomials? First, let’s define very quickly some basic terms.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/jekyll/update/2017/01/22/buchbergers_algo_groebner_basis.html">
  <link rel="alternate" type="application/rss+xml" title="Musings on Math (++)" href="/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/">Musings on Math (++)</a>

    <nav class="site-nav">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Solve a system of polynomial equations - Buchbergers algorithm for computing Groebner basis</h1>
    <p class="post-meta"><time datetime="2017-01-23T04:34:40+01:00" itemprop="datePublished">Jan 22, 2017</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="what-are-polynomials">What are polynomials?</h2>
<p>First, let’s define very quickly some basic terms.</p>

<ul>
  <li>Monomials are functions in one or more variables where we are only allowed multiplication and non-negative integer exponents. For example, <script type="math/tex">x^2 y</script> is a monomial in the variables <script type="math/tex">x</script> and <script type="math/tex">y</script>.</li>
  <li>Polynomials are functions in one or more variables that involve the operations of addition, subtraction, multiplication and non-negative integer exponents. This means, they are basically sums of monomial terms. Here is an example of a polynomial in three variables, <script type="math/tex">x, y, z</script>.</li>
</ul>

<script type="math/tex; mode=display">5x^2 y + y^2 - z - 3</script>

<h2 id="linear-ideals">Linear Ideals</h2>
<p>Before getting into polynomials, lets consider the simpler special case of linear equations (polynomials where the powers of the variables in each monomial sum to no more than one). Let’s say we are given a system of linear equations.</p>

<p>\begin{equation} a_{1,1} x + a_{1,2} y - b_1 = 0 \end{equation}</p>

<p>\begin{equation} a_{1,2} x + a_{2,2} y - b_2 = 0 \end{equation}</p>

<p>Now, we can apply any single variable functions, <script type="math/tex">f_1(u)</script>, <script type="math/tex">f_2(u)</script> such that <script type="math/tex">f_1(0) = 0</script> and <script type="math/tex">f_2(0) = 0</script> to the two equations and the sum would still be an expression that equals <script type="math/tex">0</script>.</p>

<p>\begin{equation} f_1(a_{1,1} x + a_{1,2} y - b_1 ) + f_2(a_{1,2} x + a_{2,2} y - b_2) = 0 \end{equation}</p>

<p>However, equations (1) and (2) are linear equations while this is not necessarily true for equation (3). The only functions <script type="math/tex">f_1(u)</script> and <script type="math/tex">f_2(u)</script> for which equation (3) is also a linear equation are of the form -</p>

<p>\begin{equation} f_i(u) = c_i u \end{equation}</p>

<p>Here, the <script type="math/tex">c_i</script> are constants, so these <script type="math/tex">f_i</script> are just linear equations that pass through the origin.
The operations described above would be the famous <a href="http://www.purplemath.com/modules/mtrxrows.htm">row operations</a> if the equations were written in matrix form.</p>

<p><img src="http://localhost:4000/Downloads/GaussianElimination.gif" alt="My helpful screenshot" /></p>

<p>Now, the set of all linear equations obtained through this process is infinite, but in general smaller than the set of all possible linear equations that exist. We call this smaller set the “Ideal” of linear equations. Given the two equations (1) and (2), we can generate every other linear equation in this Ideal. So, the two equations form a basis of this ideal. However, we could choose two other equations from the ideal and those would form a valid basis as well (say, the first one by adding equations (1) and (2) and the second by subtracting (2) from (1)). The natural question then becomes, which of these sets is the “best”? There is infact a basis which looks a lot more natural and elegant than all the others. And this is the <a href="https://en.wikipedia.org/wiki/Row_echelon_form">Echelon form</a>, where as far as possible, each equation involves only one variable (or as few variables as possible). This makes the region where all of these equations are solved simultaneously very obvious to see (if each equation involves just one variable, solving for that variable is trivial). We can acheive this special basis through <a href="http://mathworld.wolfram.com/GaussianElimination.html">Gaussian elimination</a>, where we systematically perform row operations until each equation involves just one variable.</p>

<h2 id="polynomial-ideals">Polynomial Ideals</h2>

<p>Polynomial bases are a generalization of systems of linear equations to polynomial equations. Let’s again consider a system of (two) quadratic equations in two variables.</p>

<p>\begin{equation}g_a(x, y) = a_{0,0} + a_{1,0} x + a_{0,1} y + a_{2,0} x^2 + a_{0,2} y^2 + a_{1, 1} xy = 0 \end{equation}</p>

<p>\begin{equation}g_b(x, y) = b_{0,0} + b_{1,0} x + b_{0,1} y + b_{2,0} x^2 + b_{0,2} y^2 + b_{1, 1} xy = 0 \end{equation}</p>

<p>Again, applying functions <script type="math/tex">f_1</script> and <script type="math/tex">f_2</script> to these eqations still results in a valid expression but that expression is not necessarily a polynomial equation. So, what should the functions be to ensure that the resulting equation is also a polynomial?</p>

<p>Unlike linear equations (where multiplying two of them produces a quadratic, not necessarily linear equation), if we multiply two polynomial equations, we just get another polynomial equation. So, we can multpily both equations (4) and (5) by any other polynomials in the same variables (<script type="math/tex">x</script> and <script type="math/tex">y</script>) and still end up with polynomials. We can then add these new polynomials together and get yet another polynomial. In other words, can consider <script type="math/tex">f_i(u) = c_i u</script> where now, <script type="math/tex">c_i</script> is a polynomial in all the variables that <script type="math/tex">g_a</script> and <script type="math/tex">g_b</script> are are polynomials in (here <script type="math/tex">x</script> and <script type="math/tex">y</script>). Then, we get -</p>

<p>\begin{equation} g_a(x,y) c_a(x,y) + g_b(x,y) c_b(x,y) = 0\end{equation}</p>

<p>For different polynomial functions, <script type="math/tex">c_a</script> and <script type="math/tex">c_b</script>, we will end up with different polynomial equations. These will again (just like with linear equations) form an infinite set which is probably smaller than the set of all possible polynomial equations in <script type="math/tex">x</script> and <script type="math/tex">y</script>. And since all we need to generate this set are <script type="math/tex">g_a</script> and <script type="math/tex">g_b</script>, we can consider them a basis of this set. Just like linear equations, the set of these polynomial equations is called the “Ideal” of polynomial equations. And again, we can think of alternate bases for this ideal (other than (<script type="math/tex">g_a</script>, <script type="math/tex">g_b</script>)). Like the Echelon form for linear equations, can we think of a collection of polynomial equations where each of them has as few variables as possible. This will again make the task of finding points that satisfy them simultaneously very easy. For polynomial ideals, this special basis is called a “Groebner basis”. It is a fairly recent invention (1965).</p>

<h2 id="applications-of-groebner-basis">Applications of Groebner Basis</h2>
<p>It is beyond the scope of this blog to go into the details of how Groebner basis are calculated and what their properties are. For that, you can read <a href="http://www.dm.unipi.it/~caboara/Misc/Cox,%20Little,%20O'Shea%20-%20Ideals,%20varieties%20and%20algorithms.pdf">the book on Ideals, Varieties and Algorithms by Cox, Little and O Shea</a> (henceforth, “CLO”), which I highly encourage you to do (I personally completed the first two chapters at the time of writing). We can however, treat them like a magic black box that produces a special type of basis for polynomial ideals. A basis that makes all problems go away. And by doing so, we can solve a surprising array of very practical problems.</p>

<p>As you can imagine, systems of polynomial equations occur in all kinds of applications. And whenever they do, Buchbergers algorithm and Groebner basis is there to foil them.</p>

<p><a href="http://www.hrpub.org/download/201306/ujcmj.2013.010102.pdf">This paper</a> is an excellent resource on this. Here are some examples -</p>

<p><img src="http://localhost:4000/Downloads/graph.svg.png" alt="My helpful screenshot" /></p>

<ul>
  <li>Optimization problems where the objective function and constraints are polynomial equations. Minimizing sum of squared errors immediately comes to mind.</li>
  <li>Robotic motion planning - let’s imagine a robotic arm consisting of various limbs. We can imagine that the length of each limb will be fixed, so the range of motion it can perform in isolation will be restricted to a circle at the hinge. When we consider many such limbs and want to find the best way to reach for an object, we get a system of polynomial equations.</li>
  <li>Finding the minimum number of colors needed to paint a graph such that no adjacent vertices have the same color. This is called the chromatic number of the graph.</li>
</ul>

<h2 id="implementation-in-c">Implementation in C#</h2>
<p>The algorithms provided in the CLO book were implemented in <a href="https://github.com/ryu577/GroebnerBasis">this git repo</a>. While there are other implementations of Buchbergers algorithm on Github, I felt a new one was needed since -</p>

<ul>
  <li>None of them were in C#.</li>
  <li>None of them were well commented and designed to be easily understandable. So, I took care to comment this code really well and since it follows <a href="http://www.dm.unipi.it/~caboara/Misc/Cox,%20Little,%20O'Shea%20-%20Ideals,%20varieties%20and%20algorithms.pdf">the most popular book on this topic</a> very closely, it is a very good companion for someone reading through it.</li>
</ul>

<p>In the <a href="https://github.com/ryu577/GroebnerBasis">code</a>, you will find C# classes for most of the algebric objects discussed in the previous sections and methods implementing the algorithms from the book. The various classes that are a part of this solution form a hierarchical structure:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>PolynomialBasis
│
└───Polynomial
    │
    └───Monomial
</code></pre>
</div>

<p>What this means is that a collection of monomials form a polynomial and a collection of polynomials form a polynomial basis. Since a polynomial basis is simply a set of polynomials, I used a HashSet to store the polynomials. However, when we think of monomials in a polynomial, the order matters. Also, we need to store not just the monomials but also their coefficients. So, I used a SortedDictionary of monomials to back up the polynomial object.</p>

<p>The code starts with the building blocks like LCM (Least Common Multiple), polynomial division, etc. and builds up to Groebner basis. Some applications 
of Groebner basis are also provided. You can execute the code via Program.cs. In the comments and documentation for the code, “CLO” referes to <a href="http://www.dm.unipi.it/~caboara/Misc/Cox,%20Little,%20O'Shea%20-%20Ideals,%20varieties%20and%20algorithms.pdf">the CLO book</a></p>

<p>Let’s see an example of how to use this code to solve systems of polynomial equations.</p>

<p>A new Polynomial basis object can be instantiated through strings which contain polynomial equations in human readable form -</p>

<script src="https://gist.github.com/ryu577/6d248504f855196f4e862eb525ed8921.js"></script>

<p>And then, the Buchbergers algorithm can be called to simplify the basis to a more natural Groebner basis. Then, we use the pretty print function to show this new basis.</p>

<script src="https://gist.github.com/ryu577/7edeabee77b66f793972dcbb37856265.js"></script>

<p>This will produce output in the following format -</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Polynomial - 0
 + 0.67-0.78 z - 0.22 z^2 - 0.11 z^3 +  x

Polynomial - 1
-2.67 - 0.22 z + 0.22 z^2 + 0.11 z^3 +  y

Polynomial - 2
-18 - 12z + 13z^2 + 5z^3 +  z^4
</code></pre>
</div>

<p>Notice that the last polynomial involves only <script type="math/tex">z</script>. We can use it to find possible solutions for this variable. The second to last one then, contains only <script type="math/tex">z</script> and <script type="math/tex">y</script>. So, the values of <script type="math/tex">z</script> calculated from the previous equation can be substituted to get possible values of <script type="math/tex">y</script>. Similarly, the first equation can be used to calculate <script type="math/tex">x</script>.</p>

<p>Now, let’s peer at the machinery behind this. Here is the simplest (and most inefficient) version of Buchbergers algorithm as provided in section 2.7, Theorem 2 for computing the Groebner basis (<script type="math/tex">g_1, g_2, \dots , g_t</script>) of a polynomial ideal, starting with an arbitrary basis (<script type="math/tex">f_1, f_2, \dots , f_s</script>). Don’t peer at it too closely here before reading the background in the book. This is meant as an illustration of how the algorithms in the book translate to the C# code. Note that the more efficient version of the Buchbergers algorithm given in theorem 11 in section 2.9 is also implemented.</p>

<p><br /></p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>INPUT: <script type="math/tex">F = (f_1,f_2, \dots , f_s)</script></td>
    </tr>
    <tr>
      <td> </td>
      <td>OUTPUT: A Groebner basis <script type="math/tex">G = (g_1, \dots , g_t )</script> for <script type="math/tex">I</script>, with <script type="math/tex">F \subset G</script></td>
    </tr>
    <tr>
      <td> </td>
      <td><script type="math/tex">G := F</script></td>
    </tr>
    <tr>
      <td> </td>
      <td>REPEAT</td>
    </tr>
    <tr>
      <td> </td>
      <td>   <script type="math/tex">G' = G</script></td>
    </tr>
    <tr>
      <td> </td>
      <td>   FOR EACH PAIR <script type="math/tex">\{p ,q\}</script>, <script type="math/tex">p \neq q</script> in <script type="math/tex">G'</script> DO</td>
    </tr>
    <tr>
      <td> </td>
      <td>     <script type="math/tex">S := \overline{S(p, q)} ^ {G'}</script></td>
    </tr>
    <tr>
      <td> </td>
      <td>     IF <script type="math/tex">S \neq 0</script> THEN <script type="math/tex">G := G \cup {S}</script></td>
    </tr>
    <tr>
      <td> </td>
      <td>UNTIL <script type="math/tex">G = G'</script></td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>And here it is implemented in C# (from the PolynomialBasis.cs file from the <a href="https://github.com/ryu577/GroebnerBasis">repo</a>):</p>

<script src="https://gist.github.com/ryu577/f6969ce0dfe43515e2849df1b881cd71.js"></script>


  </div>
  
  
    
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "https://ryu577.github.io/jekyll/update/2017/01/22/buchbergers_algo_groebner_basis.html"; // <--- use canonical URL
this.page.identifier = "/jekyll/update/2017/01/22/buchbergers_algo_groebner_basis";
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//github-io-2.disqus.com/embed.js'; // <--- use Disqus shortname

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Musings on Math (++)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Musings on Math (++)
            
            </li>
            
            <li><a href="mailto:rohitpandey576 _at_ gmail">rohitpandey576 _at_ gmail</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/ryu577"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">ryu577</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/rohitpandey576"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">rohitpandey576</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I write here about Math and other topics.
</p>
      </div>
    </div>

  </div>

</footer>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  //ga('create', '', 'auto');
  ga('create', 'UA-92632279-1', 'auto');
  ga('send', 'pageview');

</script>
  

  </body>

</html>
